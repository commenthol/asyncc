!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(t.asyncc=t.asyncc||{})}(this,function(t){"use strict";function n(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return 1===t.length&&Array.isArray(t[0])&&(t=t[0]),function(n,e){function i(n,s){var u=t[r++];n||!u?e&&e(n,s):u(s,i)}var r=0;i(null,n)}}function e(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return 1===t.length&&Array.isArray(t[0])&&(t=t[0]),function(n,e){function i(n,s){var u=t[r++];try{if(n){for(;u&&3!==u.length;)u=t[r++];u&&u(n,s,i)}else{for(;u&&u.length>2;)u=t[r++];u&&u(s,i)}}catch(o){i(o,s)}u||e&&e(n,s)}var r=0;i(null,n)}}function i(t,n,e){function i(t,i){t||n(s)?e&&e(t,i):b(function(){r()})}function r(){t(i,s++)}var s=0;r()}function r(t,n,e){i(t,function(t){return!n(t)},e)}function s(t,n,e,i){function r(t,n,e){f[t]=e,c[t]=n,n&&o.push(t),a--,u>h?s(h++):i&&!a&&(o.length||(c=null),i(c,f,o))}function s(t){var i=n[t];e(i,function(n,e){r(t,n,e)},t)}var u=n.length;t=Math.abs(t||u);var o=[],c=new Array(u),f=new Array(u),h=0,a=u;!function(){for(t=u>t?t:u;t>h;)s(h++)}()}function u(t,n,e){s(0,t,n,e)}function o(t,n,e){function i(t,n){u.push(n),t||s===o?e&&e(t,u):s>o&&b(function(){r()})}function r(){var e=t[o];n(e,i,o++)}var s=t.length,u=[],o=0;r()}function c(t){this._tasks=[],this.result=t,this.error=void 0,this._lock=!1}function f(t){return new c(t)}function h(t,n,e){function i(t,n,i){c[t]=i,o[t]=n,n&&u.push(t),h--,s>f?r(f++):e&&!h&&(u.length||(o=null),e(o,c,u))}function r(t){var e=n[t];e(function(n,e){i(t,n,e)})}var s=n.length;t=Math.abs(t||s);var u=[],o=new Array(s),c=new Array(s),f=0,h=s;!function(){for(t=s>t?t:s;t>f;)r(f++)}()}function a(t,n){h(0,t,n)}function l(){this.reset()}function p(t,n){this._task=t,this._concurrency=Math.abs(n||1),this._worker=0,this._paused=!1,this._items=new l}function m(t,n){return new p(t,n)}function _(t,n){n=n||{};var e=b,i=0,r=t;return"number"!=typeof t&&(r=t.times,i=t.lag||0),r=r||n.times||0,i&&(e=setTimeout),{times:r,lag:i,fn:e}}function v(t,n,e){function i(t,n){!t||s>=o?e&&e(t,n):f(function(){r()},c)}function r(){n(i,s++)}var s=0,u=_(t,{times:2}),o=u.times,c=u.lag,f=u.fn;r()}function y(t,n){function e(t,e){s.push(e),t||r===u?n&&n(t,s):r>u&&b(function(){i()})}function i(){var n=t[u++];n(e)}var r=t.length,s=[],u=0;i()}function d(t,n,e){function i(t,n){t||o>0&&s>=o?e&&e(t,n):f(function(){r()},c)}function r(){n(i,s++)}var s=0,u=_(t),o=u.times,c=u.lag,f=u.fn;o?r():e&&e()}function g(t,n,e){function i(n,i){n||t(s)?e&&e(n,i):b(function(){r()})}function r(){n(i,s++)}var s=0;t(s)?e&&e():r()}function k(t,n,e){g(function(n){return!t(n)},n,e)}var b=function(){return"object"==typeof process&&"function"==typeof process.nextTick?process.nextTick:"function"==typeof setImmediate?setImmediate:function(t){setTimeout(t,0)}}();c.prototype={_run:function(){var t=this;if(!this._lock){this._lock=!0;for(var n=this._tasks.shift(),e=this.error?["catch","end"]:["then","end"];n&&!~e.indexOf(n.type);)n=t._tasks.shift();if(n){var i=function(n,e){t.error=n,t.result=e||t.result,t._lock=!1,t._run()},r=n.fn;if("end"===n.type)r(this.error,this.result);else try{"catch"===n.type?r(this.error,this.result,i):r(this.result,i)}catch(s){i(s)}}else this._lock=!1}},then:function(t){return this._tasks.push({type:"then",fn:t}),this._run(),this},"catch":function(t){return this._tasks.push({type:"catch",fn:t}),this._run(),this},end:function(t){this._tasks.push({type:"end",fn:t}),this._run()}},l.prototype={get length(){return this.items.length},shift:function(){return(this.items.shift()||{}).item},push:function(t,n){var e=this.items;if("number"!=typeof n)n=1/0,e.push({prio:n,item:t});else{var i;n=Math.abs(n);for(var r=0;r<e.length;r++)if(n<e[r].prio){e.splice(r,0,{prio:n,item:t}),i=!0;break}i||e.push({prio:n,item:t})}return this},unshift:function(t){return this.items.unshift({prio:0,item:t}),this},reset:function(){this.items=[]}},p.prototype={_run:function(){var t=this,n=this,e=n._items,i=n._drain;if(this._worker-=1,0===e.length)this._worker<=0&&(this._worker=0,i&&i());else{this._worker+=1;var r=e.shift(),s=r[0],u=r[1];this._task(s,function(n,e){u&&u(n,e),b(function(){t._run()})})}},_start:function(){for(var t=this;!this._paused&&this._worker<Math.min(this._concurrency,this._items.length);)t._worker+=1,t._run();return this},get paused(){return this._paused},get idle(){return!this.length&&0===this._worker},get length(){return this._items.length},pause:function(){return this._paused=!0,this},resume:function(){return this._paused=!1,this._start()},reset:function(){return this._items.reset(),this},running:function(){return this._worker},push:function(t,n,e){return this.concat([t],n,e)},concat:function(t,n,e){var i=this;return"number"==typeof n&&(e=n,n=void 0),t.forEach(function(t){i._items.push([t,n],e)}),this._start()},unshift:function(t,n){return this._items.unshift([t,n]),this._start()},drain:function(t){return this._drain=t,this}};var w={_setImmediate:b,compose:n,connect:e,doUntil:i,doWhilst:r,each:u,eachLimit:s,eachSeries:o,noPromise:f,NoPromise:c,parallel:a,parallelLimit:h,queue:m,Queue:p,retry:v,series:y,times:d,until:g,whilst:k};t["default"]=w,t._setImmediate=b,t.compose=n,t.connect=e,t.doUntil=i,t.doWhilst=r,t.each=u,t.eachLimit=s,t.eachSeries=o,t.noPromise=f,t.NoPromise=c,t.parallel=a,t.parallelLimit=h,t.queue=m,t.Queue=p,t.retry=v,t.series=y,t.times=d,t.until=g,t.whilst=k,Object.defineProperty(t,"__esModule",{value:!0})});